# BEGIN .htaccess

<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /

# Force HTTPS
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
</IfModule>

# Enable gzip compression for faster loading
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html text/css text/javascript application/javascript application/json
</IfModule>

# Cache Control Headers - Optimized for freshness and performance
<IfModule mod_headers.c>
  # HTML: No cache - always fetch latest version
  <FilesMatch "\.(html|htm)$">
    Header set Cache-Control "no-cache, no-store, must-revalidate"
    Header set Pragma "no-cache"
    Header set Expires "0"
  </FilesMatch>

  # CSS and JavaScript: Short cache (5 minutes) with revalidation
  <FilesMatch "\.(css|js)$">
    Header set Cache-Control "public, max-age=300, must-revalidate"
  </FilesMatch>

  # Images: Moderate cache (1 hour)
  <FilesMatch "\.(jpg|jpeg|png|gif|webp|svg|ico)$">
    Header set Cache-Control "public, max-age=3600, must-revalidate"
  </FilesMatch>

  # Fonts: Longer cache (1 week)
  <FilesMatch "\.(woff|woff2|ttf|eot)$">
    Header set Cache-Control "public, max-age=604800, immutable"
  </FilesMatch>

  # Videos: Moderate cache (1 day)
  <FilesMatch "\.(mp4|webm|ogg)$">
    Header set Cache-Control "public, max-age=86400, must-revalidate"
  </FilesMatch>

  # Security Headers
  Header set X-Content-Type-Options "nosniff"
  Header set X-Frame-Options "SAMEORIGIN"
  Header set X-XSS-Protection "1; mode=block"
</IfModule>

# END .htaccess
